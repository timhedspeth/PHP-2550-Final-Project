---
title: "Food Borne Pathogens"
author: "Anthony Girard, Timothy Hedspeth, Yutong Li"
date: '2022-10-05'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


# Introduction
## Motivating question 
Have you ever woken up in the morning and saw a news headline, like "E Coli. Outbreak at Chipolte leads to national recall"? Though it is easy to shrug this off and move on, but in the United States we note that every year there are an [estimated 37 million cases of food borne illness](https://www.cdc.gov/foodborneburden/pdfs/scallan-estimated-illnesses-foodborne-pathogens.pdf).  

## Literature review 


# Data Overview 

## What data are we using 
The data that we working with in this analysis is an isolate of Samonella, which is utilized so we understand the data 


```{r}

#~~~~~~~~~~~~#
## Packages ## 
#~~~~~~~~~~~~#

library(lubridate) # working with dates 
library(tidyverse) # working with data 

# Read in the data 
setwd("~/Desktop/Semester_3/Practical/Final")
salmonella <- read.csv("source_salmonella_US.csv")
ecoli <- read.csv("E.coli_2013-2022.csv")
campylobacter <- read.csv("Campylobacter_2013-2022.csv")






```


In our analysis we have a longitudinal data set with data regarding salmonella, ranging from 2013 to 2022. 








There are 16,246 rows of the data frame that correspond to a single strain of the virus, these strains likely coulld be excluded they are rare, and there are 3 strains that are commonly observed, AG3, Enteritdis, Salmonella enterica subsp. enterica. For the sake of future analysis it would likely be beneficial to find these common strains and group by them to get common strains of the virus. 


## Variables of interest 

For our analysis there are a few variables that are of interest to our analysis. The first of which is the **Collection.date** variable, indicating when the sample was collected. **AMR_genotypes** is the Antimicrobial resistance genes, where a missing value indicates that there is no antimicrobial  resistance detected. **AST_phenotypes** tells us the phenotype based on testing, **host** is the host species, **host_disease** could be missing, **isolate_identifiers** a list alternative isolates, **isolation_source** describes the physical, environmental and/or local geographical source of the biological sample from which the sample was derived, if provided by the submitter, **epi_type** can be either clinical or environmental, **k-mer** is the organism work, **Min-same** is a measure of closeness to other isolates of the same type, **outbreak** if there is an unusal number of cases in an area, **erd_group** is the SNP cluster, **source_type** where the data comes from. 



## Missing Data 

```{r}

#~~~~~~~~~~~~~~~~#
## Missing Data ## 
#~~~~~~~~~~~~~~~~#

# The first objective of this EDA is to explore the missing patterns in our 
# data at the surface level 


# Replace Missing strings with NA 
salmonella[salmonella == ""] <- NA 
ecoli[ecoli == ""] <- NA
campylobacter[campylobacter == ""] <- NA 


## Missingness by column

# Salmonella
na_by_cols_sal <- as.data.frame(apply(salmonella,2, is.na))
sum_na_by_col_sal <- apply(na_by_cols_sal,2,sum)/nrow(na_by_cols_sal)
sum_na_by_col_sal <- as.data.frame(round(sum_na_by_col_sal,4))

# E. Coli 
na_by_cols_ecoli <- as.data.frame(apply(ecoli,2, is.na))
sum_na_by_col_ecoli <- apply(na_by_cols_ecoli,2,sum)/nrow(na_by_cols_ecoli)
sum_na_by_col_ecoli <- as.data.frame(round(sum_na_by_col_ecoli,4))

# Camplyobaceter 
na_by_cols_camp <- as.data.frame(apply(campylobacter,2, is.na))
sum_na_by_col_camp <- apply(na_by_cols_camp,2,sum)/nrow(na_by_cols_camp)
sum_na_by_col_camp <- as.data.frame(round(sum_na_by_col_camp,4))

# Get the data together 
Missing_by_col <- cbind(sum_na_by_col_sal, sum_na_by_col_ecoli, sum_na_by_col_camp)
names(Missing_by_col) <- c("x", "y", "z") # Create a dummy variable for filtering 
Missing_by_col <- Missing_by_col %>% filter(x != 0 & 
                                            y != 0 & 
                                            z != 0   )
names(Missing_by_col) <- c("Salmonella", "E. Coli", "Campylobacter")

# Print the data frame 
Missing_by_col %>% kbl(caption = "Variables with some missing observations")



## Missingness by row

# Using the commented out code below we check to see if any of the data is 
# complete for a given observation 

#sum(complete.cases(salmonella))
#sum(complete.cases(ecoli))
#sum(complete.cases(campylobacter))

# There are no complete cases in the data set 

# Salmonella 
na_by_row_sal <- as.data.frame(apply(salmonella,1, is.na))
sum_na_by_row_sal <- apply(na_by_row_sal,2,sum)/nrow(na_by_row_sal)
salmonella_missing <- as.data.frame(sum_na_by_row_sal)

# E. Coli 
na_by_row_ecoli <- as.data.frame(apply(ecoli,1, is.na))
sum_na_by_row_ecoli <- apply(na_by_row_ecoli,2,sum)/nrow(na_by_row_ecoli)
ecoli_missing <- as.data.frame(sum_na_by_row_ecoli)

# Campylobacter
na_by_row_camp <- as.data.frame(apply(campylobacter,1, is.na))
sum_na_by_row_camp <- apply(na_by_row_camp,2,sum)/nrow(na_by_row_camp)
campylobacter_missing <- as.data.frame(sum_na_by_row_camp)



ggplot(data = salmonella_missing, aes(x = sum_na_by_row_sal, color = "sum_na_by_row_sal")) + 
  geom_density(alpha = .9) + 
  geom_density(data = ecoli_missing, aes(x = sum_na_by_row_ecoli,
                                         color = "sum_na_by_row_ecoli"), alpha = .9) + 
  geom_density(data = campylobacter_missing, aes(x = sum_na_by_row_camp, 
                                                 color = "sum_na_by_row_camp"), alpha = .9)
  

```

From the information we can see that there is a great deal of missingness in this data set and the peracent missingness is relatley high for most of the variables. Though there is heterogeneity in the data, with some variables being observed frequently with one data set and being missing in the data set. 








## Exploratory Analysis 
We note that the data in this study is longitudinal in nature, we sought to quantify the trends in 
```{r, message=FALSE}
# Let us consider looking at trends over time

# We must have our data in a form that is workable form for analysis 
salmonella$Create.date <- as.Date(salmonella$Create.date) 
ecoli$Create.date <- as.Date(ecoli$Create.date)
campylobacter$Create.date <- as.Date(campylobacter$Create.date)

# Decompose the dates to day month year

# Day
salmonella$day <- day(salmonella$Create.date)
ecoli$day <- day(ecoli$Create.date)
campylobacter$day <- day(campylobacter$Create.date)

# Month 
salmonella$month <- month(salmonella$Create.date)
ecoli$month <- month(ecoli$Create.date)
campylobacter$month <- month(campylobacter$Create.date)

# Year 
salmonella$year <- year(salmonella$Create.date)
ecoli$year <- year(ecoli$Create.date)
campylobacter$year <- year(campylobacter$Create.date)




# How many Samonella cases per year? 
Num_per_year_salmonella <- salmonella %>% 
                           group_by(year) %>% 
                           summarize(num = n())

# How many ecoli cases per year? 
Num_per_year_ecoli <- ecoli %>% 
                      group_by(year) %>% 
                      summarize(num = n())

# How many ecoli cases per year? 
Num_per_year_campylobacter <- campylobacter %>% 
                              group_by(year) %>% 
                              summarize(num = n())

# Lets look at the trend over time, and 
ggplot(data = Num_per_year_salmonella, aes(x = year, y = num, color = "Salmonella")) +
  geom_point() + 
  geom_line() +
  # E coli 
  geom_point(data = Num_per_year_ecoli, aes(x = year, y = num, color = "E coli")) + 
  geom_line(data = Num_per_year_ecoli, aes(x = year, y = num, color = "E coli")) + 
  # campylobacter
  geom_point(data = Num_per_year_campylobacter, aes(x = year, y = num, color = "Campylobacter")) + 
  geom_line(data = Num_per_year_campylobacter, aes(x = year, y = num, color = "Campylobacter")) + 
  theme_minimal() + 
  labs(title= "Number of Samonella cases by year", 
       x = "Year", 
       y = "Number of cases")





# Number of cases per month 
salmonella$month1 <- month(salmonella$Create.date)
salmonella <- salmonella %>% mutate(month = case_when(month1 == 1 ~ "Jan", 
                                                      month1 == 2 ~  "Feb", 
                                                      month1 == 3 ~ "Mar", 
                                                      month1 == 4 ~ "Apr", 
                                                      month1 == 5 ~ "May", 
                                                      month1 == 6 ~ "Jun", 
                                                      month1 == 7 ~ "Jul", 
                                                      month1 == 8 ~ "Aug", 
                                                      month1 == 9 ~ "Sep", 
                                                      month1 == 10 ~ "Oct", 
                                                      month1 == 11 ~ "Nov", 
                                                      month1 == 12 ~ "Dec"))

Num_per_month_sal <- salmonella %>%  
                     group_by(year, month) %>% 
                     summarize(num =  n())
Num_per_month_sal$month <- factor(Num_per_month_sal$month, levels = c("Jan", "Feb", 
                                                                    "Mar", "Apr", "May", 
                                                                    "Jun", "Jul", "Aug", 
                                                                    "Sep", "Oct", 
                                                                    "Nov", "Dec"))
ggplot(data = Num_per_month_sal, aes(x = as.numeric(month), y = num)) + 
  geom_point(aes(color = as.factor(year))) + 
  scale_x_continuous(breaks=seq(1,12,1), labels=c("Jan", "Feb", 
                                                  "Mar", "Apr", "May", 
                                                  "Jun", "Jul", "Aug", 
                                                  "Sep", "Oct", 
                                                  "Nov", "Dec"))+
  geom_smooth()
  

table(isolated$Isolation.source)

table(isolated[c(grep("animal", isolated$Isolation.source),grep("Animal", isolated$Isolation.source))
               ,]$Isolation.source)
```

We need to begin by doing some cleaning of the data that we have in our data file, one of the main variables that we are interested in is the isolation source, as tracing the source of the infection is of great interest for our analysis. In its original form this is a factor variable with over 6,300 levels, which is due to poor reporting practices, the first objective is to greatly reduce the heterogeneity of this variable to make the analysis achievable. We will start by looking at identifying potential sources that may be reported frequently in many forms such as chicken and their by products like eggs. This analysis requires the assumption that these observations will map to true chicken data which may be a strong assumption, but without this the analysis would not be plausible.  




```{r}
x <- as.data.frame(table(salmonella$Isolation.source))
x %>% filter(Freq > 50)
```
```{r}
# This will be the cleaning of the data regarding the isolation source
# Given the extreme heterogeniety in 

# We note that there are going to be some sources 

length(levels(as.factor(salmonella$Isolation.source)))
#table(salmonella$Isolation.type)

# Lets start with chicken
salmonella[grep("chicken", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("Chicken", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("egg", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("Egg", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("Poultry", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("poultry", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("Broiler", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("broiler", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("hen", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("Hen", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("chkn", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("CHICKEN", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("chick", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("Chick", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("CB", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("EGG", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("yolk", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("POULTRY", salmonella$Isolation.source),9] <- "Chicken"
salmonella[grep("Gallus", salmonella$Isolation.source),9] <- "Chicken"



# length(levels(as.factor(salmonella$Isolation.source))) # This reduces by a factor of approx 500 

# Lets do beef 
salmonella[grep("beef", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("Beef", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("cow", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("Cow", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("Cattle", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("cattle", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("Veal", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("veal", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("bovine", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("Bovine", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("heifer", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("Heifer", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("Steer", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("steer", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("Bos taurus", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("(Bos taurus)", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("GB", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("GROUND BEEF", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("hamburger", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("calf", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("Livestock", salmonella$Isolation.source),9] <- "Cow/Beef"
salmonella[grep("livestock", salmonella$Isolation.source),9] <- "Cow/Beef"


length(levels(as.factor(salmonella$Isolation.source)))


# Pig/pork 
salmonella[grep("pork", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("Pork", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("swine", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("Swine", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("pig", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("Pig", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("porcine", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("Porcine", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("Hogs", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("hogs", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("Hog", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("hog", salmonella$Isolation.source),9] <- "Pig"
salmonella[grep("PORK", salmonella$Isolation.source),9] <- "Pig"


# Other birds 
salmonella[grep("Turkey", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("turkey", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("GT", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("gallopavo", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("duck", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Duck", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("avian", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Avian", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("seagull", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("bird", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Bird", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("crane", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Crane", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("owl", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Owl", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("crow", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Crow", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("gull", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Gull", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("eagle", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Eagle", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("finch", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Finch", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("cardinal", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("emu", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("sparrow", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Acanthis flammea", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("crossbill", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("siskin", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Leucophaeus pipixcan", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("feather", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("FEATHERBACK", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("ostrich", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("quail", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("goose", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("heron", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("egret", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Heron", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Phasianus", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("mongoose", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("monkey", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("Monkey", salmonella$Isolation.source),9] <- "Birds (other)"
salmonella[grep("moose", salmonella$Isolation.source),9] <- "Birds (other)"


# Other animals 
salmonella[grep("Catfish", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Reptile", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("reptile", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Wildlife", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("wildlife", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("fish", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Fish", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("earthworm", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Earthworm", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("oyster", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Oyster", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("gecko", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Gecko", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("clam", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Clam", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("squid", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Squid", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("scallop", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Scallop", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("horse", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("lamb", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Lamb", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("crab", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Crab", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("mouse", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("rodent", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("dragon", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("sheep", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("cat", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Cat", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("tuna", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Tuna", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("caprine", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Caprine", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Canine", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Canis", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("canine", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("dog", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("dolphin", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Dragon", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("prawn", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("elk", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("equine", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Equine", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Sus", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("alpaca", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("feline", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Feline", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("pet", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("squirrel", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("snail", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("tilapia", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("lizard", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("frog", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("barrramundi", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("octopus", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("conch", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("koral", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("eel", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("opossumm", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("golden", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("salmon", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("anchovy", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("kangaroo", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("lobster", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("sand goby", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("sardine", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("scad", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("snapper", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("trout", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("corvina", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("pomfret", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("bass", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("shell", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("rhizome", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("mullet", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("rhizome", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("snakehead", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("croaker", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("mackerel", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("trevally", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("fusilier", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("barb", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("seabream", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("gizzard", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("GIZZARDS", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("GOAT", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("goat", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("rabbit", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("haddock", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("halibut", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("hamster", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("hare", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Iguana", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("iguana", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("tortise", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Tortise", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Alligator", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("alligator", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Bison", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("taurus", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Equus", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Meleagris", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Odocoileus", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Ovis", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Procyon", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Puma", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Rattus", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Serpentes", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Simalia", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("sm", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Capra", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Rhea", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Mussels", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("snake", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Lizard", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("llama", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("mamal", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("marine", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("marsupial", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Marsupial,", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("deer", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("muscle", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("mussel", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("Opossum", salmonella$Isolation.source),9] <- "Other animal"
salmonella[grep("opossum", salmonella$Isolation.source),9] <- "Other animal"



# Greens 
salmonella[grep("Lettuce", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("lettuce", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("cilantro", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Agricultural", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("agricultural", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("peppercorn", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("agricultural", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("canaloupe", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("cucumber", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("leafy green", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Leafy green", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("leafy greens", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Leafy greens", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Leaf", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("leaf", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("leaves", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Leaves", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("sage", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Sage", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Sage", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("lemon", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Lemon", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Corn", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("corn", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("chickpea", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("tomato", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("chard", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("carrot", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("cantaloupes", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("cantaloupe", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Cantaloupe", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("pepper", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("ginger", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("cabbage", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("fennel", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("spinach", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("kale", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("green", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("spring mixture", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("asparagus", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Peppers", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("squash", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("jalapeno", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("mango", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("pineapple", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("peas", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("vegetable", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("basil", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("mammey", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("blueberry", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Galia", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("grape", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("Kernel", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("lime", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("flower", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("melon", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("fruit", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("CACTUS", salmonella$Isolation.source),9] <- "Plants"
salmonella[grep("sprout", salmonella$Isolation.source),9] <- "Plants"




length(levels(as.factor(salmonella$Isolation.source)))

# Milk 
salmonella[grep("Dairy", salmonella$Isolation.source),9] <- "Milk"
salmonella[grep("dairy", salmonella$Isolation.source),9] <- "Milk"
salmonella[grep("Milk", salmonella$Isolation.source),9] <- "Milk"
salmonella[grep("milk", salmonella$Isolation.source),9] <- "Milk"
salmonella[grep("yogurt", salmonella$Isolation.source),9] <- "Milk"
salmonella[grep("Yougurt", salmonella$Isolation.source),9] <- "Milk"
salmonella[grep("cheese", salmonella$Isolation.source),9] <- "Milk"
salmonella[grep("Cheese", salmonella$Isolation.source),9] <- "Milk"


length(levels(as.factor(salmonella$Isolation.source)))

# Nuts 
salmonella[grep("pistachio", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("peanut butter", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("macadamia nut", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("sesame seed", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("tree nut", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("Tree nut", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("seed", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("Seed", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("seeds", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("chaoli", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("cashew", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("pecan", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("nut", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("Nut", salmonella$Isolation.source),9] <- "Nut"
salmonella[grep("peanut", salmonella$Isolation.source),9] <- "Nut"


# Food/meat 
salmonella[grep("carcass", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("chili powder", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("coriander powder", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("frozen shrimp", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Frozen shrimp", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("meat", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Meat", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("meats", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Meats", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("papaya", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("shrimp", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Shrimp", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("oregano", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Oregano", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("parsley", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Parsley", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Potato", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("potato", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("dessert", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("curry", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("cummin", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("coriander", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("tea", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("cookie", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Ice Cream", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("ice cream", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Ice cream", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("cooked", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("coconut", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("coleslaw", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("rice", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Rice", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("cinnamon", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Cinnamon", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Chocolate", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("chocolate", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("chili", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("chia", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("snack", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("chamomile", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("mushroom", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("mushrooms", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Mushroom", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("celery", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("CARCASS", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Carcass", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("carcass", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("salami", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("dried", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Dried", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("dry", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Dry", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("enchilada", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("broth", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("meal", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("flour", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("fluff", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Fluff", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("FLUFF", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Food", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("FOOD", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("food", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("calamari", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("fillet", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("garam", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("garlic", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("gelatin", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("tola", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("fillet", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("guacamole", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("gum", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("ghaleem", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("halwa", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("ham", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("herb", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("spice", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Spice", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("hummus", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("protein", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("noodle", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Jambalaya", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("mixture", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("spicy", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("lasagna", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("soup", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Mayo", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Mayonnaise", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("mayonnaise", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("meringue", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("cream", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("mexican", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("minced", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("bean", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Mousse", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("Mung", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("vanilla", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("fillet", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("sauce", salmonella$Isolation.source),9] <- "Food/meat"
salmonella[grep("onion", salmonella$Isolation.source),9] <- "Food/meat"


# Water 
salmonella[grep("water", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("Water", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("River", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("river", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("Pond", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("pond", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("River", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("Canal", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("canal", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("Dam", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("dam", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("sediment", salmonella$Isolation.source),9] <- "Water" # assuming the sediment was from water 
salmonella[grep("Sediment", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("Creek", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("creek", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("Drainage", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("estuary", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("Foam", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("laguna", salmonella$Isolation.source),9] <- "Water"
salmonella[grep("lake", salmonella$Isolation.source),9] <- "Water"


# Human, presumed 
salmonella[grep("caecum", salmonella$Isolation.source),9] <- "Human" # https://www.britannica.com/science/cecum 
salmonella[grep("cloacal swab", salmonella$Isolation.source),9] <- "Human" # https://www.childrenshospital.org/conditions/cloacal-deformities#:~:text=What%20is%20a%20cloacal%20deformity,the%20surface%20of%20the%20skin.
salmonella[grep("human", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Human", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("intestine", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("liver", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("urine", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("person", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Person", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Colon", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("colon", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("COLON", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("spleen", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("child", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Child", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("cecum", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Cecum", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Cecal", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("cecal", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("digestive", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("ear", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Elderly", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Family", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("family", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("foot", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("gall bladder", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Gallbladder", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("gallbladder", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Gastric", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Genital", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("GI", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Granuloma", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Gut", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("gut", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("hand", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("HEARTS", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Hip", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Homo", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Hommo", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("ileum", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Ileum", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Internal", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("internal", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("intestinal", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("joint", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Joint", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("kidney", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("knee", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("legs", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("LEGS", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Liver", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("lung", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("lymph node", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Lymph Node", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Lymphnode", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("meconium", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Mouth", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("nasal", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Nasal", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Nasopharyngeal", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("Neck", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("skin", salmonella$Isolation.source),9] <- "Human"
salmonella[grep("newborn", salmonella$Isolation.source),9] <- "Human"


# Farms 
salmonella[grep("farm", salmonella$Isolation.source),9] <- "Farm/salughterhouse"
salmonella[grep("Farm", salmonella$Isolation.source),9] <- "Farm/salughterhouse"
salmonella[grep("Slaughterhouse", salmonella$Isolation.source),9] <- "Farm/salughterhouse"
salmonella[grep("Feed", salmonella$Isolation.source),9] <- "Farm/salughterhouse"
salmonella[grep("feed", salmonella$Isolation.source),9] <- "Farm/salughterhouse"
salmonella[grep("field", salmonella$Isolation.source),9] <- "Farm/salughterhouse"
salmonella[grep("manure", salmonella$Isolation.source),9] <- "Farm/salughterhouse"


# General clinical
salmonella[grep("clinical", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("Clinical", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("culture", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("Culture", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("patient", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("clinic", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("hospital", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("Hybrid", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("Isolated", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("lab", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("Lab", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("Laboratory", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("laboratory", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("strain", salmonella$Isolation.source),9] <- "Clinical"
salmonella[grep("assembly", salmonella$Isolation.source),9] <- "Clinical"



# Enviornment
salmonella[grep("Enviornment", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("enviornment", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("Enviornmental", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("enviornmental", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("swab", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("ENVIR", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("Envirnoment", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("Environemnt", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("environment", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("Environment", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("Environment", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("Environmental", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("environmental", salmonella$Isolation.source),9] <- "Enviornment"
salmonella[grep("forest", salmonella$Isolation.source),9] <- "Enviornment"



# Other/not collected 
salmonella[grep("not collected", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Not collected", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Not Collected", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("not Collected", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Other", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("other", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("not known", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Not known", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Not Known", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("not Known", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("shoe", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Doors", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("doors", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("door", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Door", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("DRAGSW", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Drums", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Dust", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("dust", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Duvet", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("eared", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("embryo", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("pool", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Factory", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("fan", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("fenugreek", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Fertilizer", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("fertilizer", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("supplement", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("floor", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("freezer", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("sadao", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("FSWAB", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Gauze", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("anaerobes", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("granary", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("GROUND", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("ground", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Hatchery", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Havana", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("hay", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("hide", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("iceberg", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("incubator", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Index", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("INTCNTL", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("ISOLATE", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Jeonju", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Kali", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("kennel", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("layer", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("least", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("lesser", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("litter", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Litter", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("LITTER", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("PLANT", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("market", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("market", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("mace", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Limosa", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("marjoram", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Melagris", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("melagris", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Mesenteric", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("moringa", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Moringa", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("mrigal", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("not", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Not", salmonella$Isolation.source),9] <- "Other/Not collected"
salmonella[grep("Ocean", salmonella$Isolation.source),9] <- "Other/Not collected"





#salmonella[grep("Animal Feed", salmonella$Isolation.source),9] <- "Animal feed"

# Raw/ food borne stuff 
#salmonella[grep("Raw", salmonella$Isolation.source), 9] <- "Raw"
#salmonella[grep("raw", salmonella$Isolation.source), 9] <- "raw"

#salmonella[grep()]


# abscess 
salmonella[grep("abscess", salmonella$Isolation.source), 9] <- "abscess"
salmonella[grep("Abscess", salmonella$Isolation.source), 9] <- "abscess"
salmonella[grep("abcess", salmonella$Isolation.source), 9] <- "abscess"
salmonella[grep("Abcess", salmonella$Isolation.source), 9] <- "abscess"

# chicken 



length(levels(as.factor(salmonella$Isolation.source.category)))

```




```{r}
## Lets start doing some eda with some of the categories we have defiend 
lots <- as.data.frame(table(salmonella$Isolation.source.category)) 
x <- lots %>% filter(Freq > 1000)
x1 <- as.vector(x[,1])
sal_subset <- salmonella %>% 
              filter(Isolation.source.category %in% x1)


plotdata <- sal_subset %>% group_by(year, Isolation.source.category) %>% summarize(num = n())

ggplot(data = plotdata, aes(x = year, y = num, color = Isolation.source.category)) + 
  geom_line() + 
  geom_point()
```

We assume that if there is a missing value in the min difference column this will mean that there is no relation to other strains. 

```{r}
# Lets look at Min differences

Missing_min_same <- length(which(is.na(sal_subset$Min.same)))/nrow(sal_subset)
close_min_same <- length(which(sal_subset$Min.same <= 7))/nrow(sal_subset)
far_min_same <- length(which(sal_subset$Min.same > 7))/nrow(sal_subset)

min_same_salmonella <- data.frame()
min_same_salmonella[1,1] <- "Missing"
min_same_salmonella[1,2] <- round(Missing_min_same,2)
min_same_salmonella[2,1] <- "Closely related (within 7 SNPs)"
min_same_salmonella[2,2] <- round(close_min_same,2)
min_same_salmonella[3,1] <- "Not closely related"
min_same_salmonella[3,2] <- round(far_min_same,2)
names(min_same_salmonella) <- c("Minimum Same", "Percent")

min_same_salmonella %>% kbl()

```

We observe that the min same is the same. Are there temporal trends by region?

```{r}
# Month and year 
sal_subset %>%  group_by(year, month) %>% 
                summarize(meaa = mean(Min.same, na.rm = T), 
                          num_mn = sum(is.na(Min.same)), 
                          num = n())
```

